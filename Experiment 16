from tensorflow.keras.datasets import mnist
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense, Flatten
from tensorflow.keras.optimizers import Adam, SGD

(Xtr, ytr), (Xte, yte) = mnist.load_data()
Xtr, Xte = Xtr/255.0, Xte/255.0

for opt in [Adam(0.001), SGD(0.01)]:
    model = Sequential([Flatten(), Dense(128, activation='relu'), Dense(10, activation='softmax')])
    model.compile(optimizer=opt, loss='sparse_categorical_crossentropy', metrics=['accuracy'])
    model.fit(Xtr, ytr, epochs=3, batch_size=64, verbose=0)
    print(opt._name_, model.evaluate(Xte, yte, verbose=0))
