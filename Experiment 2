import numpy as np, matplotlib.pyplot as plt
from sklearn.linear_model import LinearRegression
from sklearn.preprocessing import PolynomialFeatures
from sklearn.metrics import mean_squared_error
from sklearn.model_selection import train_test_split

X = np.linspace(-3,3,100).reshape(-1,1)
y = 0.5*X.ravel()**3 - X.ravel() + np.random.randn(100)*3
Xtr, Xte, ytr, yte = train_test_split(X,y)
for d in [1,5,15]:
    poly = PolynomialFeatures(d)
    m = LinearRegression().fit(poly.fit_transform(Xtr), ytr)
    print("Degree", d, "MSE=", mean_squared_error(yte, m.predict(poly.transform(Xte))))
