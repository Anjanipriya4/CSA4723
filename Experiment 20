from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import LSTM, Dense
from tensorflow.keras.datasets import imdb
from tensorflow.keras.preprocessing import sequence

(Xtr, ytr), (Xte, yte) = imdb.load_data(num_words=5000)
Xtr, Xte = sequence.pad_sequences(Xtr, maxlen=100), sequence.pad_sequences(Xte, maxlen=100)
model = Sequential([LSTM(64, input_shape=(100,)), Dense(1, activation='sigmoid')])
model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])
model.fit(Xtr, ytr, epochs=1, batch_size=64, verbose=0)
print("Accuracy:", model.evaluate(Xte, yte, verbose=0)[1])
