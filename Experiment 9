from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
from sklearn.datasets import make_moons
from sklearn.model_selection import train_test_split

X, y = make_moons(500, noise=0.25)
Xtr, Xte, ytr, yte = train_test_split(X, y)
for h in [4,8,16]:
    m = Sequential([Dense(h, activation='relu', input_shape=(2,)), Dense(1, activation='sigmoid')])
    m.compile(optimizer='adam', loss='binary_crossentropy', metrics=['acc'])
    m.fit(Xtr, ytr, epochs=50, verbose=0)
    print(f"Hidden {h}: acc={m.evaluate(Xte, yte, verbose=0)[1]:.3f}")
